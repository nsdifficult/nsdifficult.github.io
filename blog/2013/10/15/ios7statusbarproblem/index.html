
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>iOS7中的status bar问题 - RONGYI.WORK</title>
	<meta name="author" content="易荣义">

	
	<meta name="description" content="首先推荐这篇文章：Redesign Your App for iOS 7 之 页面布局 在iOS7中状态栏默认透明，且视图默认全屏。在实际开发中发现当直接在一个UIVIewController中添加一个UITableview时会发生table中内容在status bar后面的问题。 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="RONGYI.WORK" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="http://libs.useso.com/js/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">RONGYI.WORK</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">主页</a></li>
	<li><a href="/blog/archives">所有文章</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">主页</a></li>
	<li><a href="/blog/archives">所有文章</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:rongyi.work">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:rongyi.work">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">iOS7中的status Bar问题</h2>
	<div class="entry-content"><p>首先推荐这篇文章：<a href="http://www.vinqon.com/codeblog/?detail/11109">Redesign Your App for iOS 7 之 页面布局</a></p>

<p>在iOS7中状态栏默认透明，且视图默认全屏。在实际开发中发现当直接在一个UIVIewController中添加一个UITableview时会发生table中内容在status bar后面的问题。<!--more--></p>

<p><img src="https://developer.apple.com/library/ios/qa/qa1797/Art/qa1797_1.png" alt="status bar cover view" /></p>

<p>苹果官网有个解决办法： <a href="https://developer.apple.com/library/ios/qa/qa1797/_index.html#top">How do I prevent the status bar from covering my views in iOS 7?</a></p>

<p>实际试验后发现对其他视图（如UIToolBar）都有效。但在storyboard环境下，在一个UIViewController上直接添加一个UITableView时，使用这种方法并不奏效，网上有讨论说这是一个bug。见：<a href="http://stackoverflow.com/questions/18900428/ios-7-uitableview-shows-under-status-bar">iOS 7: UITableView shows under status bar</a>。</p>

<p>后来使用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[self.tableViewMain setContentInset:UIEdgeInsetsMake(20, self.tableViewMain.contentInset.left, self.tableViewMain.contentInset.bottom, self.tableViewMain.contentInset.right)];</span></code></pre></td></tr></table></div></figure>


<p>解决问题。</p>

<h2>解释</h2>

<h3>topLayoutGuide</h3>

<p>上面的<a href="https://developer.apple.com/library/ios/qa/qa1797/_index.html#top">解决办法</a>中有提到UIVIewController的属性<a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UIViewController/topLayoutGuide">topLayoutGuide</a>。</p>

<p>topLayoutGuide是只有在auto Layout时使用，指出屏幕内容垂直方向最高的内容显示范围。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@property(nonatomic, readonly, retain) id&lt;UILayoutSupport&gt; topLayoutGuide</span></code></pre></td></tr></table></div></figure>


<p>更详细见：<a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UIViewController/topLayoutGuide">topLayoutGuide</a></p>

<h3>iOS7中的status bar</h3>

<p>iOS7中状态栏只有两种style：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>typedef NS_ENUM(NSInteger, UIStatusBarStyle) {
</span><span class='line'>    UIStatusBarStyleDefault                                     = 0, // Dark content, for use on light backgrounds
</span><span class='line'>    UIStatusBarStyleLightContent     NS_ENUM_AVAILABLE_IOS(7_0) = 1, // Light content, for use on dark backgrounds
</span><span class='line'>    
</span><span class='line'>    UIStatusBarStyleBlackTranslucent NS_ENUM_DEPRECATED_IOS(2_0, 7_0, "Use UIStatusBarStyleLightContent") = 1,
</span><span class='line'>    UIStatusBarStyleBlackOpaque      NS_ENUM_DEPRECATED_IOS(2_0, 7_0, "Use UIStatusBarStyleLightContent") = 2,
</span><span class='line'>};</span></code></pre></td></tr></table></div></figure>


<p>可见只剩默认（深色背景时使用）UIStatusBarStyleDefault和浅色背景时使用的UIStatusBarStyleLightContent两种style。</p>

<p>iOS7中我们通过ViewController重载方法返回枚举值的方法来控制状态栏的隐藏和样式</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- (UIStatusBarStyle)preferredStatusBarStyle
</span><span class='line'>{
</span><span class='line'>    return UIStatusBarStyleLightContent;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>- (BOOL)prefersStatusBarHidden
</span><span class='line'>{
</span><span class='line'>    return NO;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>并需要在Info.plist配置文件中，增加键：UIViewControllerBasedStatusBarAppearance，并设置为YES</p>

<p>在需要刷新状态栏样式的时候，调用[self setNeedsStatusBarAppearanceUpdate]方法即可刷新</p>

<h2>iOS7中UIViewController如何展示views及一些属性解释</h2>

<p><a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/TransitionGuide/AppearanceCustomization.html#//apple_ref/doc/uid/TP40013174-CH15-SW1">iOS 7 UI Transition Guide</a></p>

<h4>edgesForExtendedLayout</h4>

<blockquote><p>The edgesForExtendedLayout property uses the UIRectEdge type, which specifies each of a rectangle’s four edges, in addition to specifying none and all.</p>

<p>Use edgesForExtendedLayout to specify which edges of a view should be extended, regardless of bar translucency. By default, the value of this property is UIRectEdgeAll.</p></blockquote>

<p>即edgesForExtendedLayout是一个类型为UIExtendedEdge的属性，指定边缘要延伸的方向。默认UIRectEdgeAll，即四周边缘都延伸。</p>

<h4>automaticallyAdjustsScrollViewInsets</h4>

<blockquote><p>If you don’t want a scroll view’s content insets to be automatically adjusted, set automaticallyAdjustsScrollViewInsets to NO. (The default value of automaticallyAdjustsScrollViewInsets is YES.)</p></blockquote>

<p>当使用UIScrollView或其子类（如UITableView）时，当automaticallyAdjustsScrollViewInsets=YES时，它会自动设置相应的内边距。UIScrollView会占据整个视图，又不会让导航栏遮盖。</p>

<h4>extendedLayoutIncludesOpaqueBars</h4>

<blockquote><p>If your design uses opaque bars, refine edgesForExtendedLayout by also setting the extendedLayoutIncludesOpaqueBars property to NO. (The default value of extendedLayoutIncludesOpaqueBars is YES.)</p></blockquote>

<p>当Bar使用了不透明图片时，视图是否延伸至Bar所在区域，默认值时NO。YES时视图则会延伸至导航栏。</p>

<h4>topLayoutGuide, bottomLayoutGuide</h4>

<blockquote><p>The topLayoutGuide and bottomLayoutGuide properties indicate the location of the top or bottom bar edges in a view controller’s view. If bars should overlap the top or bottom of a view, you can use Interface Builder to position the view relative to the bar by creating constraints to the bottom of topLayoutGuide or to the top of bottomLayoutGuide. (If no bars should overlap the view, the bottom of topLayoutGuide is the same as the top of the view and the top of bottomLayoutGuide is the same as the bottom of the view.) Both properties are lazily created when requested.</p></blockquote>

<p>topLayoutGuide, bottomLayoutGuide指定了顶部或者底部的bar的边缘在UIViewController中view里的位置。</p>

<h2>在运行时设置status bar的颜色</h2>

<p>在实际项目中发现使用xib（storyboard）的viewcontroller的属性定义status bar的颜色为default或者light content时，有时候会不起作用。这时候可以选择在运行时设置：即在代码中设置</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[UIApplication sharedApplication].statusBarStyle = UIStatusBarStyleLightContent;</span></code></pre></td></tr></table></div></figure>



</div>


<div class="meta">
	<div class="date">




Oct 15th, 2013</div>
	<div class="tags">

</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		
		
	</div>
	
</div>



｛% if site.duoshuo_short_name and site.duoshuo_comments == true and page.comments == true %｝
  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite">｛% include post/duoshuo1.html %｝</div>
  </section>
｛% endif %｝</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    易荣义

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>