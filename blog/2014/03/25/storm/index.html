
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Mac OS Xä¸Šå®‰è£…Storm - å›¾æ ·å›¾æ£®ç ´å•ŠğŸ˜„</title>
	<meta name="author" content="æ˜“è£ä¹‰">

	
	<meta name="description" content="Storm é›†ç¾¤çš„ç»„æˆéƒ¨åˆ† ä¸€ä¸ªStormé›†ç¾¤å¯ä»¥ç®€å•çš„è®¤ä¸ºå’ŒHadoopé›†ç¾¤ç±»ä¼¼ã€‚ä½†æ˜¯åœ¨Hadoopä¸Šä½ è¿è¡Œâ€œMapReduce jobsâ€è€Œåœ¨Stormä¸Šä½ è¿è¡Œâ€œtopologiesï¼ˆæ‹“æ‰‘ï¼‰â€ã€‚â€Jobsâ€å’Œâ€œtopologiesâ€æ˜¯ä¸åŒçš„ï¼ï¼ï¼ä¸€ä¸ªå…³é”®çš„ä¸åŒç‚¹æ˜¯MapReduce &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="å›¾æ ·å›¾æ£®ç ´å•ŠğŸ˜„" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="http://libs.useso.com/js/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">å›¾æ ·å›¾æ£®ç ´å•ŠğŸ˜„</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">ä¸»é¡µ</a></li>
	<li><a href="/blog/archives">æ‰€æœ‰æ–‡ç« </a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">ä¸»é¡µ</a></li>
	<li><a href="/blog/archives">æ‰€æœ‰æ–‡ç« </a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:rongyi.work">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:rongyi.work">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Mac OS Xä¸Šå®‰è£…Storm</h2>
	<div class="entry-content"><h2>Storm é›†ç¾¤çš„ç»„æˆéƒ¨åˆ†</h2>

<p>ä¸€ä¸ªStormé›†ç¾¤å¯ä»¥ç®€å•çš„è®¤ä¸ºå’ŒHadoopé›†ç¾¤ç±»ä¼¼ã€‚ä½†æ˜¯åœ¨Hadoopä¸Šä½ è¿è¡Œâ€œMapReduce jobsâ€è€Œåœ¨Stormä¸Šä½ è¿è¡Œâ€œtopologiesï¼ˆæ‹“æ‰‘ï¼‰â€ã€‚â€Jobsâ€å’Œâ€œtopologiesâ€æ˜¯ä¸åŒçš„ï¼ï¼ï¼ä¸€ä¸ªå…³é”®çš„ä¸åŒç‚¹æ˜¯MapReduce jobæœ€ç»ˆå®Œæˆæ—¶åœæ­¢ï¼Œè€Œä¸€ä¸ªtopology processes messages æ°¸è¿œä¸ä¼šåœæ­¢ï¼ˆé™¤éä½ killå®ƒï¼‰ã€‚<!--more--></p>

<p>Storm é›†ç¾¤ä¸Šæœ‰ä¸¤ç§èŠ‚ç‚¹ï¼šmaster nodeå’Œworker èŠ‚ç‚¹ï¼ˆä»¥åç®€ç§°ä¸»èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹ï¼‰ã€‚ä¸»èŠ‚ç‚¹è¿è¡Œä¸€ä¸ªåä¸ºâ€œNimbusâ€&lt;n.(äººå’Œç‰©äº§ç”Ÿçš„)çµæ°”ï¼›å…‰è½®ï¼›[æ°”è±¡] é›¨äº‘ï¼›å…‰è¾‰ç¿çƒ‚çš„æ°”æ°›>çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œç±»ä¼¼äºHadoopçš„â€œJobTrackerâ€ã€‚Nimbusè´Ÿè´£åœ¨é›†ç¾¤ä¸­åˆ†é…ï¼ˆdistributingï¼‰ä»£ç ï¼Œç»™æœºå™¨åˆ†é…ï¼ˆassigningï¼‰ä»»åŠ¡ï¼Œç›‘æµ‹ï¼ˆmonitoringï¼‰å¤±è´¥ã€‚</p>

<p>æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹è¿è¡Œä¸€ä¸ªå«åšâ€œSupervisorâ€ï¼ˆn. ç›‘ç£äººï¼Œ[ç®¡ç†] ç®¡ç†äººï¼›æ£€æŸ¥å‘˜ï¼‰å®ˆæŠ¤è¿›ç¨‹ã€‚Supervisoræœ‰ä¸¤ä¸ªä»»åŠ¡ï¼šç›‘å¬åˆ†é…ç»™å®ƒçš„æœºå™¨å’ŒåŸºäºNimbusåˆ†é…ç»™å®ƒçš„ä»»åŠ¡ï¼åœ¨å¿…è¦æ—¶å¼€å§‹æˆ–ç»“æŸå·¥ä½œè¿›ç¨‹ï¼ˆworker processesï¼‰ã€‚æ¯ä¸ªå·¥ä½œè¿›ç¨‹æ‰§è¡Œä¸€éƒ¨åˆ†æ‹“æ‰‘ï¼ˆtopologyï¼‰ï¼Œä¸€ä¸ªè¿è¡Œä¸­æ‹“æ‰‘åŒ…æ‹¬ä¸€äº›æœºå™¨ä¸Šçš„worker processesã€‚</p>

<p>æ‰€æœ‰Nimbuså’ŒSupervisorsä¹‹é—´çš„åè°ƒé€šè¿‡<a href="http://zookeeper.apache.org/">Zookeeper</a>é›†ç¾¤ã€‚æ­¤å¤–ï¼ŒNimbuså®ˆæŠ¤è¿›ç¨‹å’ŒSupervisorå®ˆæŠ¤è¿›ç¨‹æ˜¯fail-fastï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰å’Œstatelessï¼ˆadj. æ²¡æœ‰å›½å®¶çš„ï¼›æ— å›½å®¶ä¸»æƒçš„ï¼›æ— çŠ¶æ€çš„ï¼‰ï¼›æ‰€æœ‰çš„çŠ¶æ€éƒ½ä¿å­˜åœ¨Zookeeperæˆ–è€…æœ¬åœ°ç£ç›˜ä¸­ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥kill  -9 Nimbus zæˆ–è€…Supervisorsï¼Œä½†ä»–ä»¬ä¼šæ¢å¤å¹¶å¼€å§‹å°±åƒä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿè¿‡ã€‚è¿™ä¸ªè®¾è®¡å¯¼è‡´äº†Stormé›†ç¾¤éå¸¸ç¨³å®šã€‚</p>

<h2>å®‰è£…</h2>

<h3>zookeeper</h3>

<p><a href="http://jbowles.github.io/blog/2013/02/08/zookeeper-setup-on-mac/">http://jbowles.github.io/blog/2013/02/08/zookeeper-setup-on-mac/</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew update && brew install zookeeper</span></code></pre></td></tr></table></div></figure>


<p></p>

<h3>Omq</h3>

<p><a href="http://ptgoetz.github.io/blog/2013/11/26/building-storm-on-osx-mavericks/">http://ptgoetz.github.io/blog/2013/11/26/building-storm-on-osx-mavericks/</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew versions zeromq
</span><span class='line'>cd /usr/local
</span><span class='line'>git checkout 381c97f Library/Formula/zeromq.rb
</span><span class='line'>brew install zeromq</span></code></pre></td></tr></table></div></figure>


<p></p>

<h3>JZMQ</h3>

<p>æ¶ˆæ¯å¤„ç†ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone https://github.com/nathanmarz/jzmq.git
</span><span class='line'>brew install pkg-config
</span><span class='line'>brew install automake
</span><span class='line'>brew install libtool
</span><span class='line'>export JAVA_HOME=$(/usr/libexec/java_home -v1.6)
</span><span class='line'>sudo ln -s /System/Library/Frameworks/JavaVM.framework/Versions/Current/Headers/ /Library/Java/Home/include
</span><span class='line'>cd jzmq
</span><span class='line'>./autogen.sh
</span><span class='line'>./configure
</span><span class='line'>touch src/classdist_noinst.stamp
</span><span class='line'>cd src
</span><span class='line'>javac -d . org/zeromq/*.java
</span><span class='line'>cd ../
</span><span class='line'>make
</span><span class='line'>sudo make install</span></code></pre></td></tr></table></div></figure>


<h3>Leiningen</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir ~/bin
</span><span class='line'>curl https://raw.github.com/technomancy/leiningen/stable/bin/lein -o ~/bin/lein
</span><span class='line'>chmod +x ~/bin/lein
</span><span class='line'>export PATH=$PATH:~/bin</span></code></pre></td></tr></table></div></figure>


<h3>build Storm</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone https://github.com/nathanmarz/storm.git
</span><span class='line'>cd storm
</span><span class='line'>lein sub install</span></code></pre></td></tr></table></div></figure>


<h2>å‘½ä»¤</h2>

<p><code>jps</code>æŸ¥çœ‹javaè¿›ç¨‹</p>

<p><code>which java</code>æŸ¥çœ‹å‘½ä»¤åœ°å€</p>

<p><code>echo  $JAVA_HOME</code>è¾“å‡ºJAVA_HOMEçš„ç¯å¢ƒå˜é‡å€¼</p>

<p><code>env</code> æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡</p>

<p><code>export PATH=$PATH:$JAVA_HOME</code>å°†JAVA_HOMEç¯å¢ƒå˜é‡æ·»åŠ åˆ°path</p>

<p><code>zkServer start/stop</code> å¯åŠ¨ï¼åœæ­¢zookeeper</p>

<h3>å¯åŠ¨stormï¼š</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>storm nimbus &
</span><span class='line'>storm supervisor &
</span><span class='line'>storm ui &</span></code></pre></td></tr></table></div></figure>


<p></p>

<h3>æäº¤topology</h3>

<p><code>storm jar jaråŒ…è·¯å¾„ com.edgar.ç±»å arg1 arg2 arg3</code></p>

<h3>è¿›ç¨‹åç§°(ç”¨äºæŸ¥è¯¢)</h3>

<p>è¿è¡Œjpså¯æŸ¥è¯¢</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yirongyi-d:bin yirongyi$ jps
</span><span class='line'>684
</span><span class='line'>1354 supervisor //storm supervisorè¿›ç¨‹
</span><span class='line'>1351 nimbus //storm nimbusè¿›ç¨‹
</span><span class='line'>752
</span><span class='line'>1330 QuorumPeerMain //zkServerè¿›ç¨‹
</span><span class='line'>1363 Jps
</span><span class='line'>1360 core //storm UIè¿›ç¨‹</span></code></pre></td></tr></table></div></figure>


<h3>è¿è¡Œtopology</h3>

<p><code>storm jar all-my-code.jar backtype.storm.MyTopology arg1 arg2</code></p>

<p>å¦‚æœä¸æŒ‡å®štopologyçš„åç§°ï¼Œstormå°†topologyä»¥æœ¬åœ°æ¨¡å¼è¿è¡Œï¼Œä¸”storm uiä¸æ˜¾ç¤ºã€‚å¦‚ï¼š</p>

<p><code>storm jar storm-starter-0.0.1-SNAPSHOT-jar-with-dependencies.jar
storm.starter.ExclamationTopology exclamation-topo</code></p>

<h2>RedHat5.4 X86ä¸‹å®‰è£…</h2>

<h3>é…ç½®yumçš„163æº</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rpm -qa|grep yum  //æŸ¥çœ‹ç³»ç»Ÿrpmç‰ˆæœ¬
</span><span class='line'>rpm -aq|grep yum|xargs rpm -e --nodeps //åˆ é™¤è‡ªå¸¦rpm
</span><span class='line'>//ä¸‹è½½
</span><span class='line'>wget http://tel.mirrors.163.com/centos/5/os/x86_64/CentOS/m2crypto-0.16-9.el5.x86_64.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/python-elementtree-1.2.6-5.x86_64.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/python-iniparse-0.2.3-6.el5.noarch.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/python-sqlite-1.1.7-1.2.1.x86_64.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/python-urlgrabber-3.1.0-6.el5.noarch.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/yum-3.2.22-40.el5.centos.noarch.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/yum-fastestmirror-1.1.16-21.el5.centos.noarch.rpm
</span><span class='line'>wget http://mirrors.163.com/centos/5/os/x86_64/CentOS/yum-metadata-parser-1.1.2-4.el5.x86_64.rpm
</span><span class='line'>//å®‰è£…
</span><span class='line'>rpm -ivh python-iniparse-0.2.3-6.el5.noarch.rpm python-elementtree-1.2.6-5.x86_64.rpm python-sqlite-1.1.7-1.2.1.x86_64.rpm python-urlgrabber-3.1.0-6.el5.noarch.rpm
</span><span class='line'>rpm -ivh m2crypto-0.16-9.el5.x86_64.rpm
</span><span class='line'>rpm -ivh yum-metadata-parser-1.1.2-4.el5.x86_64.rpm
</span><span class='line'>rpm -ivh yum-3.2.22-40.el5.centos.noarch.rpm yum-fastestmirror-1.1.16-21.el5.centos.noarch.rpm  //å¿…é¡»åŒæ—¶å®‰è£…ï¼Œé¿å…äº’ç›¸å®‰è£…ä¾èµ–
</span><span class='line'>//å¯¼å…¥å…¬é’¥
</span><span class='line'>rpm -import http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-5
</span><span class='line'>//è®©yumä½¿ç”¨ç½‘æ˜“çš„æºï¼š
</span><span class='line'>cd /etc/yum.repos.d/
</span><span class='line'>wget http://mirrors.163.com/.help/CentOS-Base-163.repo
</span><span class='line'>vi CentOS-Base-163.repo
</span><span class='line'>[åœ¨æ‰€æœ‰mirrorlistå‰é¢åŠ ä¸Š#ï¼ŒæŠŠæ‰€æœ‰$releaseveræ›¿æ¢æˆ5ï¼Œä¿å­˜]
</span><span class='line'>//æ¸…ç†å¹¶é‡æ–°ç”Ÿæˆyumç¼“å­˜
</span><span class='line'>yum clean metadata
</span><span class='line'>yum makecache
</span><span class='line'>//æ›´æ–°æ‰€æœ‰è½¯ä»¶ï¼Œç½‘é€Ÿæ…¢å°±ä¸è¦æ›´æ–°äº†
</span><span class='line'>yum -y upgrade</span></code></pre></td></tr></table></div></figure>


<h3>å®‰è£…storm</h3>

<h4>å®‰è£…zeroMQ</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget http://download.zeromq.org/zeromq-4.0.4.tar.gz
</span><span class='line'>tar -xzf zeromq-4.0.4.tar.gz
</span><span class='line'>cd zeromq-2.1.7
</span><span class='line'>./configure
</span><span class='line'>make
</span><span class='line'>sudo make install</span></code></pre></td></tr></table></div></figure>


<h4>å®‰è£…zookeeper</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//å®‰è£…ruby1.9.3
</span><span class='line'>wget http://cache.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p545.tar.gz
</span></code></pre></td></tr></table></div></figure>

</div>


<div class="meta">
	<div class="date">




Mar 25th, 2014</div>
	<div class="tags">

</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    æ˜“è£ä¹‰

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>